---
title: "p8105_hw4_yy2827_problem2"
author: "Yunqiu Yao"
date: "10/25/2017"
output: html_document
---

```{r}
library(tidyverse)
library(janitor)
library(ggridges)
library(ggthemes)
```

# Problem 2

### yy2827 ("project lead")
```{r part1, warning=F}
pols = read_csv("./data/pols-month.csv") %>% 
  clean_names() %>% 
  mutate(date=lubridate::floor_date(mon,"month")) %>% 
  select(date,everything(),-mon)

gdp = read_csv("./data/GDP.csv") %>% 
  clean_names() %>% 
  mutate(value=as.numeric(value))

pols_gdp = left_join(pols,gdp,by="date") %>%
  drop_na(value) %>% 
  filter(value != ".") %>% 
  mutate(prez=ifelse(prez_dem==0,"gop","dem"),
         prez=as.factor(prez)) %>%
  select(date,prez,everything(),-c(prez_gop,prez_dem))
```

### yy2828 ("collaborator")

We make a plot to show the GDP value over time, in which blue and red points represent democratic and republican presidents, respectively. It is interesting that the party of president changed every two consecutive terms. The GDP value changed periodly and trended to be less fluctuant during 1949 and 2015. Actually, it is hardly to tell which party did better based on the plot.

```{r}
pols_gdp %>%
  ggplot(aes(x = date, y = value)) +
    geom_line() +
    geom_point(aes(color = prez)) +
## change the colors of parties.
    scale_color_manual(values = c("blue", "red")) +
    labs(
      title = "GDP value over time",
      x = "date",
      y = "GDP value",
      color = "party of president"
    ) +
    theme_bw() +
    scale_x_date(date_breaks = "5 years",
               date_labels = "%Y") +
    theme(legend.position = "bottom")
```



